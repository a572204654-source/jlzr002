# 云存储环境变量配置清单

## 必需的环境变量

在腾讯云 CloudBase 云托管控制台中，需要配置以下环境变量才能使用云存储功能：

### 1. CloudBase 环境ID
```
Key: CLOUDBASE_ENV
Value: your-cloudbase-env-id
```
**注意**：云托管会自动注入 `CLOUDBASE_ENV` 环境变量，通常无需手动配置。

### 2. 腾讯云 API 密钥ID
```
Key: TENCENTCLOUD_SECRET_ID
Value: YOUR_SECRET_ID
```

### 3. 腾讯云 API 密钥Key
```
Key: TENCENTCLOUD_SECRET_KEY
Value: YOUR_SECRET_KEY
```

## 配置步骤

1. 登录 [腾讯云 CloudBase 控制台](https://console.cloud.tencent.com/tcb)
2. 选择你的环境
3. 进入 **云托管** → **服务管理** → 选择你的服务
4. 进入 **配置管理** → **环境变量**
5. 添加 `TENCENTCLOUD_SECRET_ID` 和 `TENCENTCLOUD_SECRET_KEY` 环境变量
   - **注意**：`CLOUDBASE_ENV` 由云托管自动注入，通常无需手动配置
6. **保存并重启服务**（重要！）

## 验证配置

配置完成后，运行以下命令验证：

```bash
node test-cloud-config.js
```

或者访问诊断接口：

```bash
curl https://api.yimengpl.com/diagnose
```

检查返回结果中的 `cloudStorage` 部分：
- `hasEnvId` 应该为 `true`
- `hasSecretId` 应该为 `true`
- `hasSecretKey` 应该为 `true`
- `isConfigured` 应该为 `true`

## 注意事项

1. **必须重启服务**：修改环境变量后，必须重启云托管服务才能生效
2. **变量名大小写**：环境变量名必须完全匹配，区分大小写
3. **不要有空格**：环境变量的值前后不要有多余的空格
4. **安全性**：这些密钥是敏感信息，不要提交到代码仓库

## 当前状态

根据最新诊断结果：
- ✅ `CLOUDBASE_ENV`: 已配置（云托管自动注入）
- ✅ `TENCENTCLOUD_SECRET_ID`: 已配置
- ✅ `TENCENTCLOUD_SECRET_KEY`: 已配置

## 测试文件上传

配置完成后，运行测试脚本：

```bash
node test-upload-ai.js
```

如果配置正确，文件上传应该成功。

