-- 为项目、工程、监理日志表添加置顶字段
-- 生成时间: 2024-11-07

USE `jlzr1101-5g9kplxza13a780d`;

-- ============================================================================
-- 1. 为项目表添加 is_pinned 字段
-- ============================================================================
ALTER TABLE `projects` 
ADD COLUMN `is_pinned` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否置顶：0-未置顶, 1-已置顶' AFTER `creator_id`,
ADD INDEX `idx_is_pinned` (`is_pinned`);

-- ============================================================================
-- 2. 为单项工程表添加 is_pinned 字段
-- ============================================================================
ALTER TABLE `works` 
ADD COLUMN `is_pinned` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否置顶：0-未置顶, 1-已置顶' AFTER `creator_id`,
ADD INDEX `idx_is_pinned` (`is_pinned`);

-- ============================================================================
-- 3. 为监理日志表添加 is_pinned 字段
-- ============================================================================
ALTER TABLE `supervision_logs` 
ADD COLUMN `is_pinned` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否置顶：0-未置顶, 1-已置顶' AFTER `reviewer_date`,
ADD INDEX `idx_is_pinned` (`is_pinned`);

-- ============================================================================
-- 完成
-- ============================================================================
-- 执行此脚本后，三个表将具有置顶功能
-- 前端可以通过 POST /api/projects/:id/pin 等接口来置顶/取消置顶

